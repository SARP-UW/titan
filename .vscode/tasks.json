{
  "version": "2.0.0",
  "tasks": [
    {
      "type": "shell",
      "label": "configure_dev",
      "detail": "Configures dev build.",
      "command": "cmake -G Ninja ../dev",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}/build"
      }
    },
    {
      "type": "shell",
      "label": "configure_test",
      "detail": "Configures test build.",
      "command": "cmake -DTITAN_TEST_PORT=\"STM32H745\" -G Ninja ../test",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}/build"
      }
    },
    {
      "type": "shell",
      "label": "clean",
      "detail": "Cleans build directory.",
      "command": "ninja clean",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}/build"
      }
    },
    {
      "type": "shell",
      "label": "build",
      "detail": "Builds code.",
      "command": "ninja",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}/build"
      }
    },
    {
      "type": "shell",
      "label": "flash_dev",
      "detail": "Flashes dev build.",
      "command": "openocd -f dev/resource/flash_config.cfg -c 'program build/TITAN_DEV.elf verify reset exit'",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}"
      }
    },
    {
      "type": "shell",
      "label": "flash_test",
      "detail": "Flashes test build.",
      "command": "openocd -f dev/resource/flash_config.cfg -c 'program build/TITAN_TEST.elf verify reset exit'",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}"
      }
    },
    {
      "type": "shell",
      "label": "xbuild_dev",
      "detail": "Cleans, configures and builds dev code.",
      "dependsOn": [
        "clean",
        "configure_dev",
        "build"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": "$gcc",
    },
    {
      "type": "shell",
      "label": "xbuild_test",
      "detail": "Cleans, configures and builds test code.",
      "dependsOn": [
        "clean",
        "configure_test",
        "build"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": "$gcc",
    },
    {
      "type": "shell",
      "label": "xflash_dev",
      "detail": "Cleans, configures, builds and flashes dev code.",
      "dependsOn": [
        "xbuild_dev",
        "flash_dev"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": "$gcc",
      "group": {
        "kind": "build",
        "isDefault": true
      }
    },
    {
      "type": "shell",
      "label": "xflash_test",
      "detail": "Cleans, configures, builds and flashes test code.",
      "dependsOn": [
        "xbuild_test",
        "flash_test"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": "$gcc",
      "group": {
        "kind": "test",
        "isDefault": true
      }
    }
  ],
}