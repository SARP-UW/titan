{
  "version": "2.0.0",
  "tasks": [
    {
      "type": "shell",
      "label": "configure_dev",
      "detail": "Configures dev build.",
      "command": "cmake -G Ninja ..",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}/dev/build"
      }
    },
    {
      "type": "shell",
      "label": "configure_test",
      "detail": "Configures test build.",
      "command": "cmake -G Ninja --target TITAN_STM32H745_TEST ..",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}/test/build"
      }
    },
    {
      "type": "shell",
      "label": "clean_dev",
      "detail": "Cleans dev build directory.",
      "command": "ninja clean",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}/dev"
      }
    },
    {
      "type": "shell",
      "label": "clean_test",
      "detail": "Cleans test build directory.",
      "command": "ninja clean",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}/test"
      }
    },
    {
      "type": "shell",
      "label": "build_dev",
      "detail": "Builds dev code.",
      "command": "ninja",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}/dev"
      }
    },
    {
      "type": "shell",
      "label": "build_test",
      "detail": "Builds test code.",
      "command": "ninja",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}/test"
      }
    },
    {
      "type": "shell",
      "label": "flash_dev",
      "detail": "Flashes dev build.",
      "command": "openocd -f dev/resource/flash_config.cfg -c 'program dev/build/TITAN_DEV.elf verify reset exit'",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}"
      }
    },
    {
      "type": "shell",
      "label": "flash_test",
      "detail": "Flashes test build.",
      "command": "openocd -f dev/resource/flash_config.cfg -c 'program test/build/TITAN_STM32H745_TEST.elf verify reset exit'",
      "problemMatcher": "$gcc",
      "options": {
        "cwd": "${workspaceFolder}"
      }
    },
    {
      "type": "shell",
      "label": "xbuild_dev",
      "detail": "Cleans, configures and builds dev code.",
      "dependsOn": [
        "clean_dev",
        "configure_dev",
        "build_dev"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": "$gcc",
    },
    {
      "type": "shell",
      "label": "xbuild_test",
      "detail": "Cleans, configures and builds test code.",
      "dependsOn": [
        "clean_test",
        "configure_test",
        "build_test"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": "$gcc",
    },
    {
      "type": "shell",
      "label": "xflash_dev",
      "detail": "Cleans, configures, builds and flashes dev code.",
      "dependsOn": [
        "xbuild_dev",
        "flash_dev"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": "$gcc",
      "group": {
        "kind": "build",
        "isDefault": true
      }
    },
    {
      "type": "shell",
      "label": "xflash_test",
      "detail": "Cleans, configures, builds and flashes test code.",
      "dependsOn": [
        "xbuild_test",
        "flash_test"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": "$gcc",
      "group": {
        "kind": "test",
        "isDefault": true
      }
    }
  ],
}